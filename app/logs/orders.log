2025-06-02 23:58:31,294 - INFO - orders - Application starting up - Orders logging initialized
2025-06-02 23:59:28,831 - INFO - orders - Application starting up - Orders logging initialized
2025-06-02 23:59:42,386 - INFO - orders - Application starting up - Orders logging initialized
2025-06-03 00:00:49,111 - INFO - orders - Application starting up - Orders logging initialized
2025-06-03 00:01:21,274 - INFO - orders - Application starting up - Orders logging initialized
2025-06-03 00:02:11,853 - INFO - orders - Application starting up - Orders logging initialized
2025-06-03 00:02:25,538 - INFO - orders - Application starting up - Orders logging initialized
2025-06-03 00:02:31,236 - INFO - orders - Order placement request received - User ID: 1, User Type: live, Request Type: live
2025-06-03 00:02:31,266 - INFO - orders - Current user class: User
2025-06-03 00:02:31,266 - INFO - orders - Using order model class: UserOrder
2025-06-03 00:02:31,267 - INFO - orders - Calculating margin for order - Symbol: AUDCAD, Type: BUY, Quantity: 0.01
2025-06-03 00:02:31,267 - INFO - orders - User details - ID: 1, Type: live, Group: Group B
2025-06-03 00:02:31,267 - INFO - orders - Starting margin calculation for user 1, symbol AUDCAD, order_type BUY
2025-06-03 00:02:31,269 - INFO - orders - User data from cache: {'id': 1, 'group_name': 'Group B', 'leverage': Decimal('100.00'), 'wallet_balance': Decimal('10000.00000000'), 'margin': Decimal('0E-8')}
2025-06-03 00:02:31,269 - INFO - orders - Found user data in cache - leverage: 100.00, group: Group B
2025-06-03 00:02:31,286 - INFO - orders - Symbol type for AUDCAD: 1
2025-06-03 00:02:31,286 - INFO - orders - Fetching group settings for group 'Group B', symbol 'AUDCAD'
2025-06-03 00:02:31,288 - INFO - orders - Group settings from cache: {'commision_type': 1, 'commision_value_type': 0, 'type': 1, 'pip_currency': 'USD', 'show_points': 5, 'swap_buy': Decimal('-6.5528'), 'swap_sell': Decimal('-1.1040'), 'commision': Decimal('10.0000'), 'margin': Decimal('1.0000'), 'spread': Decimal('0.0000'), 'deviation': Decimal('0.4000'), 'min_lot': Decimal('0.0100'), 'max_lot': Decimal('10.0000'), 'pips': Decimal('10.0000'), 'spread_pip': Decimal('0.0001'), 'contract_size': Decimal('100000.00000000'), 'profit_currency': 'CAD'}
2025-06-03 00:02:31,288 - INFO - orders - Raw values from cache - spread: 0.0000, spread_pip: 0.0001, margin: 1.0000
2025-06-03 00:02:31,288 - INFO - orders - Parsed values - spread: 0.0000, spread_pip: 0.0001, margin: 1.0000
2025-06-03 00:02:31,288 - INFO - orders - Fetching ExternalSymbolInfo for symbol AUDCAD
2025-06-03 00:02:31,299 - INFO - orders - ExternalSymbolInfo found: <ExternalSymbolInfo(fix_symbol='AUDCAD', instrument_type='1', contract_size=100000.00000000)>
2025-06-03 00:02:31,299 - INFO - orders - Symbol info - contract_size: 100000.00000000, profit_currency: CAD, digits: 5.00000
2025-06-03 00:02:31,299 - ERROR - orders - Unexpected error during margin calculation for user 1, symbol AUDCAD, order_type BUY: name 'get_adjusted_market_price_cache' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\margin_calculator.py", line 251, in calculate_single_order_margin
    adjusted_prices = await get_adjusted_market_price_cache(redis_client, user_group_name, direct_conversion_symbol)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name 'get_adjusted_market_price_cache' is not defined
2025-06-03 00:02:31,308 - INFO - orders - Margin calculation results - Margin: None, Adjusted Price: None, Contract Value: None
2025-06-03 00:02:31,308 - ERROR - orders - Margin calculation returned None values
